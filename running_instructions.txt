### Commands to run to setup environment and download models: ###

conda create --name raft
conda activate raft
conda install pytorch=1.6.0 torchvision=0.7.0 cudatoolkit=10.1 matplotlib tensorboard scipy opencv pandas -c pytorch
conda install -c conda-forge azure-storage-blob
conda install -c anaconda pyyaml
./download_models.sh

### Before running, edit azure_info.yaml to have the proper credentials to read and write blobs from Azure storage for both input video data and output flow data. Connection string and container name for download and upload are required. ###


### Command to run training job for one node ###
python3 video_flow_distributed_azure.py --model=models/raft-sintel.pth --azure_data_path=official --output_path=official_flow --azure_yaml_file azure_info.yaml --total_nodes <number of nodes> --node_id <id of current node>


